# 一 模型 & 协议

| OSI模型              | 网络协议                          | TCP/IP模型 |
| -------------------- | --------------------------------- | ---------- |
| 应用层/表示层/会话层 | Telnet/FT/SMTP/HTTP/DNS/SNMP/TFTP | 应用层     |
| 传输层               | TCP/UDP                           | 传输层     |
| 网络层               | IP                                | 网络层     |
| 数据链路层/物理层    | TokenRing/HDLC/PPP                | 网络链接层 |



# 二 TCP VS UDP

## 2.1 相同点

二者均是传输层的协议

## 2.2 不同点

| TCP                   | UDP                             |
| --------------------- | ------------------------------- |
| 有连接                | 无连接                          |
| 可靠(确认码,重传机制) | 不可靠(有校验和,但非必选)       |
| 全双工                | 单工                            |
| 数据流                | 短报文(长度受限)                |
| 一对一                | 一对多                          |
| 有流量控制(滑动窗口)  | 无流量控制,大量数据可能堵塞主机 |

* 一对一 VS 一对多

  一对一体现在一条消息只能由一个接受者,而一对多的话一条消息可以有多个接收者

  一个服务进程可以通过同一个端口同时和多个客户端进程进行TCP绑定，这个并不违反一对多的特性

## 2.3 UDP

### 2.3.1 报文格式

| 源端口号(2byte) | 目的端口号(2byte) | 报文长度(2byte) | 校验和(2byte) | 内容(16*n) |
| --------------- | ----------------- | --------------- | ------------- | ---------- |

* 报文头

  包含源端口号/目的端口号/报文长度/校验和,四项内容,每项2字节,共8字节

* 源/目的端口号

  2字节表示，因此取值范围 1-65536

* 报文长度

  2字节表示,因此最长65535字节

  报文长度包含报文头(8字节),因此最短8字节

* 校验和

  可选项.计算校验和时,需要在UDP报文前添加“伪头部”. 

  因此,参与校验和计算的包含三部分内容: 伪头部/报文头/报文内容

* 伪头部

| 源IP(4byte) | 目的IP(4byte) | 常量0(1byte) | 协议号(1byte,固定17表示UDP) | 报文长度(2byte,同报文头) |
| ----------- | ------------- | ------------ | --------------------------- | ------------------------ |

​	源IP和目的IP由IP报文中获得

* 报文内容

  需要对齐至16字节的倍数



## 2.4 TCP

### 2.4.1 报文格式

| 报文头(20 + 4*n) | 报文内容 |
| ---------------- | -------- |

### 2.4.2 报文头

|源端口(2)|目的端口(2)|Seq(4)|Ack(4)|

# 1 http

http: 超文本传输协议,从服务器传输超文本到本地浏览器的传送协议。默认端口 80

## 1.0 特点

* 无连接: 每次连接只处理一个请求,之后断开连接
* 媒体独立: 可以传输任何类型数; 使用MIME-type指定内容类型
* 无状态: 对事务的处理没有记忆

## 1.1 历史发展

| 版本 | 方法           | 特点                                               |
| ---- | -------------- | -------------------------------------------------- |
| 0.9  | GET            | 不支持header,无状态码;只能回应html                 |
| 1.0  | GET/POST/HEAD  | 增加header;增加状态码;可以传输任何格式             |
| 1.1  | PUT/DELETE/... | 支持长链接;增加管道,一个TCP连接发送多个请求;       |
| 2.0  |                | 二进制分帧;多路复用;请求优先级;header压缩;推送功能 |



## 1.2 方法

| 方法    | 版本 | 描述                               |
| ------- | ---- | ---------------------------------- |
| GET     | 0.9  | 请求指定的页面信息，并返回实体主体 |
| HEAD    | 1.0  | 获取报头                           |
| POST    | 1.0  | 对自定资源进行新建/修改            |
| PUT     | 1.1  | 对指定文档进行修改                 |
| DELETE  | 1.1  | 请求对指定页面进行删除             |
| CONNECT | 1.1  | 将连接改为管道方式                 |
| OPTIONS | 1.1  | 查看服务器性能                     |
| TRACE   | 1.1  | 回显服务器收到的请求,主要用于诊断  |
| PATCH   | 1.1  | PUT的补充,对资源进行局部修改       |



## 1.3 消息格式

* 客户端消息

客户端消息包括: 请求行/请求头/空行/请求数据

<img src="clientMsg.png" alt="binder" />



* 服务器响应消息

<img src="serverMsg.jpeg" alt="binder" />

### 1.4 消息头

部分消息头内容

| 消息头           | 说明                   |
| ---------------- | ---------------------- |
| Allow            | 服务器支持哪些请求方法 |
| Content-Encoding | 编码格式               |
| Content-Length   | 内容长度               |
| Content-Type     | 文档MIME类型           |
| Date             | 当前GMT时间            |



## 1.5 https

超文本传输安全协议. 默认端口443

通过加密保证所传输数据的安全性

http vs https

|          | http     | https       |
| -------- | -------- | ----------- |
| 默认端口 | 80       | 443         |
| 文本传输 | 明文传输 | SSL加密传输 |
| CA证书   | 不需要   | 需要        |



## 2 tcp vs udp

### 2.1 tcp三次握手

| 握手序号 | 发送方 | 序列                  | 状态变化                     |
| -------- | ------ | --------------------- | ---------------------------- |
| 1        | 客户端 | SYN=1, Seq=x, Ack=0   | 客户端:SYN_SEND              |
| 2        | 服务端 | SYN=1, Seq=y, Ack=x+1 | 服务端: SYN_RECV             |
| 3        | 客户端 | Seq=x+1, Ack=y+1      | 客户端 & 服务端: ESTABLISHED |



## 3 OSI七层模型



## 4 internet四层模型



# Socket

